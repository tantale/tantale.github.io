
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="canonical" href="https://tantale.github.io/en/articles/requirements/">
      
      <link rel="icon" href="../../../images/favicon.ico">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-7.3.6">
    
    
      
        <title>Requirements - Tantale’s Blog</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.a57b2b03.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.3f5d1f46.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
    
      


    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    <script>function __prefix(e){return new URL("../../..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#requirements" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Tantale’s Blog" class="md-header__button md-logo" aria-label="Tantale’s Blog" data-md-component="logo">
      
  <img src="../../../images/Tantale-logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Tantale’s Blog
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Requirements
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Tantale’s Blog" class="md-nav__button md-logo" aria-label="Tantale’s Blog" data-md-component="logo">
      
  <img src="../../../images/Tantale-logo.png" alt="logo">

    </a>
    Tantale’s Blog
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1" type="checkbox" id="__nav_1" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_1">
          Function parameters deprecation
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Function parameters deprecation" data-md-level="1">
        <label class="md-nav__title" for="__nav_1">
          <span class="md-nav__icon md-icon"></span>
          Function parameters deprecation
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Requirements
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Requirements
      </a>
      
        


<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#abstract" class="md-nav__link">
    Abstract
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#advantages-and-disadvantages-of-the-decorator" class="md-nav__link">
    Advantages and disadvantages of the decorator
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#generalization" class="md-nav__link">
    Generalization
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#examples-of-deprecations" class="md-nav__link">
    Examples of deprecations
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#implementation-guide" class="md-nav__link">
    Implementation Guide
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../deprecated_params/" class="md-nav__link">
        Deprecated Parameters Decorator
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../about/" class="md-nav__link">
        About
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#abstract" class="md-nav__link">
    Abstract
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#advantages-and-disadvantages-of-the-decorator" class="md-nav__link">
    Advantages and disadvantages of the decorator
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#generalization" class="md-nav__link">
    Generalization
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#examples-of-deprecations" class="md-nav__link">
    Examples of deprecations
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#implementation-guide" class="md-nav__link">
    Implementation Guide
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="requirements">Requirements</h1>
<hr />
<ul>
<li>title: Deprecate a function parameter – Requirements</li>
<li>summary: What are the requirements to implement a parameter deprecation decorator?</li>
<li>author: Laurent LAPORTE</li>
<li>date: 2019-03-01</li>
</ul>
<hr />
<h2 id="abstract">Abstract</h2>
<p>When a program evolves, we sometimes have to change a function signature.
But this leads to a version incompatibility which is not sustainable by the user.</p>
<p>Instead of doing this, it is often easier to slightly change the function parameters,
for instance by adding keyword parameters (or by using <code>*args</code>/<code>**kwargs</code>).
Then it is better to emit a warning when the user uses an obsolete parameter.</p>
<p>There are of course other use cases where we want to deprecate a parameter, for instance when a parameter is renamed:
we keep the old parameter and add a new one, both parameters becoming optional. Then we need to add a code snippet
to check the parameters to make sure that at least one of them is used. Then we emit a warning message when the old
parameter is used.</p>
<p>The purpose of this article is to define the requirements to implement a decorator. To do so, we will give the
advantages and disadvantages of a decorator. Then we will try to generalize the requirements to find out if other use
cases could not also be taken into account. We will continue by looking for examples of deprecated parameters in open
source libraries. Finally, we will discuss the implementation of such a decorator, taking inspiration from what is
already done in the Deprecated library.</p>
<p>To illustrate our point, here is an example of a function to create a styled paragraph in HTML. Here, the <em>color</em>
and <em>background_color</em> parameters are replaced by a more generic <em>style</em> parameter. Both parameters are now deprecated.</p>
<pre><code class="language-python">import xml.sax.saxutils


@deprecated_params(
    params='color background_color',
    version=&quot;0.2.3&quot;,
    reason=&quot;you may consider using *styles* instead.&quot;,
)
def paragraph(text, color=None, background_color=None, styles=None):
    &quot;&quot;&quot;Create a styled HTML paragraphe.&quot;&quot;&quot;
    styles = styles or {}
    if color:
        styles['color'] = color
    if background_color:
        styles['background-color'] = background_color
    html_styles = &quot; &quot;.join(&quot;{k}: {v};&quot;.format(k=k, v=v) for k, v in styles.items())
    html_text = xml.sax.saxutils.escape(text)
    return ('&lt;p styles=&quot;{html_styles}&quot;&gt;{html_text}&lt;/p&gt;'
            .format(html_styles=html_styles, html_text=html_text))
</code></pre>
<p>In this example, we used a decorator named <code>@deprecated_params</code> to define the deprecated parameters.
Such a decorator could be implemented as follows:</p>
<pre><code class="language-python">import functools


def deprecated_params(params, version=&quot;&quot;, reason=&quot;&quot;):
    def decorate(func):
        @functools.wraps(func)
        def call(*args, **kwargs):
            # todo: check deprecated parameters here...
            return func(*args, **kwargs)

        return call

    return decorate
</code></pre>
<h2 id="advantages-and-disadvantages-of-the-decorator">Advantages and disadvantages of the decorator</h2>
<p>Using a decorator to deprecate the use of a function parameter is interesting and offers some advantages:</p>
<ul>
<li>The decorator allows you to isolate the code that checks the use of this parameter from the rest of the function
  processing: Separation of Concerns design pattern.</li>
<li>The decorator allows explicit documentation of the code, so the use of comments is unnecessary: “Readability matters”.</li>
<li>The decorator could be used to enhance the code documentation (the docstring of the decorated function).</li>
</ul>
<p>Disadvantages:</p>
<ul>
<li>The implementation of such a decorator is necessarily more complex than a specific solution.</li>
<li>The resulting function (after decoration) is necessarily slower than the decorated function because of the
  introspection and parameters usage check.</li>
</ul>
<p>Another important consideration:</p>
<ul>
<li>The resulting function (after decoration) must be of the same nature as the decorated function: function, method,
  static method, etc.</li>
</ul>
<h2 id="generalization">Generalization</h2>
<p>In addition to the case of deprecating a parameter usage, a warning could also be issued in the following cases:</p>
<ul>
<li>A parameter has been renamed: the new name is more meaningful, more explicit, etc.</li>
<li>One parameter is replaced by another of more general use.</li>
<li>The parameter type changes, it is better to use another one.</li>
<li>A parameter is considered obsolete, it will be deleted in a future version.</li>
<li>A new parameter has been added, its use is strongly recommended.</li>
<li>Etc.</li>
</ul>
<p>The use cases mentioned above fall into 3 categories:</p>
<ol>
<li>Deleted parameter,</li>
<li>Added parameter,</li>
<li>Modified parameter (default value, modified type or use).</li>
</ol>
<p>The third case (modified parameter) is the most difficult to specify in general terms.</p>
<h2 id="examples-of-deprecations">Examples of deprecations</h2>
<p>(This section is incomplete)</p>
<p>Before starting a complex implementation, it would be necessary to study how it is done, on one hand in
the <a href="https://docs.python.org/3/library/index.html">Standard Library</a>, and on the other hand in
the <a href="https://hugovk.github.io/top-pypi-packages/">popular libraries</a> of the Open Source world such as: pip, urllib3,
boto3, six, requests, setuptools, futures, Flask, Django… At least two questions must be considered regarding
deprecation:</p>
<ul>
<li>How is it implemented in the source code?</li>
<li>How is it documented?</li>
</ul>
<h2 id="implementation-guide">Implementation Guide</h2>
<p>(This section is incomplete)</p>
<p>A parameter deprecation decorator implementation must be flexible. It is necessary to be as flexible as possible and to
use what exists for <code>@deprecated.basic.deprecated</code> and <code>@deprecated.sphinx.deprecated</code>. It is necessary to define test
cases that correspond to the most common scenarios. It is also likely that some atypical situations are clearly not
implemented. For now, we would like to continue supporting Python 2.7, as it is still used by some users.</p>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
      
        
        <a href="../deprecated_params/" class="md-footer__link md-footer__link--next" aria-label="Next: Deprecated Parameters Decorator" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Deprecated Parameters Decorator
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        
          Made with
          <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
            Material for MkDocs
          </a>
        
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../../..", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../../assets/javascripts/workers/search.fcfe8b6d.min.js", "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.b1047164.min.js"></script>
      
    
  </body>
</html>